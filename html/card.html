<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Braavo</title>
    <link rel="stylesheet" href="/styles/reset.css">
    <link rel="stylesheet" href="/styles/card-style.css">
</head>

<body>

    <div class="wrapper">
        <div class="text-about-offer">
            <h1> Your special offer!</h1>
            <p class="upper-text"> Get 50% off - Today only!</p>
            <h1 class="payment-method-text">Payment Method</h1>
        </div>

        <div class="box-for-payment">
            <div class="order">
                <div class="text-order">
                    <h1 class="order-summary">Order summary:</h1>
                    <div class="order-plan-text">
                        <span class="plan-days-text">
                            <div id="plan_name"></div>
                        </span>
                        <span class="plan-price-text">$<span id="plan_price"></span></span>
                    </div>
                    <hr>
                    <div class="after-discount-text">
                        <span class="total-after">Total after discount:</span>
                        <span class="total-price">$<span id="plan_price_total"></span></span>
                    </div>
                </div>

                <div class="payment-info">
                    <span class="payment-info-text">Payment information</span>
                    <div class="secure-info">
                        <img src="/svg/secure.svg" alt="secure" class="logo-secure">
                        <span class="secure-server-text">Secure Server</span>
                    </div>
                </div>

                <form action="post">
                    <div class="card-info">
                        <div class="card-number">
                            <input type="text" class="card-number-enter-text" id="cardNumber" placeholder="Card number"
                                required>
                        </div>

                        <div class="card-number">
                            <input type="text" class="card-owner-enter-text" id="owner" placeholder="Cardholder name" required>
                        </div>

                        <div class="card-cvv-date">
                            <div class="card-date">
                                <input type="text" class="card-date-enter-text" id="expiration-date" placeholder="MM/YY"
                                    required>
                            </div>
                            <div class="card-cvv">
                                <input type="text" class="card-cvv-enter-text" id="cvv" placeholder="CVV" required>
                            </div>
                        </div>
                    </div>

                    <div class="bottom-info-card">
                        <div class="cards-variants">
                            <span class="cards-variants-text">
                                Powered by Stripe
                            </span>
                            <div class="cards-variants-logos">
                                <img src="/svg/mastercard.svg" alt="mastercard" class="logo-card">
                                <img src="/svg/maestro.svg" alt="maestro" class="logo-card">
                                <img src="/svg/visa.svg" alt="visa" class="logo-card">
                                <img src="/svg/paypal.svg" alt="paypal" class="logo-card">
                            </div>
                        </div>
                        <button class="get-plan-button">
                            GET MY PLAN NOW
                        </button>
                        <div class="cancel-anytime">
                            <img src="/svg/accept-logo.svg" alt="accept" class="cancel-anytime-logo">
                            <span class="cancel-anytime-text">No commitments - Cancel anytime</span>
                        </div>
                    </div>
                </form>



            </div>
            <div class="shadow"></div>
        </div>
    </div>

    <script>
        let params = (new URL(document.location)).searchParams;
        var plan_id = params.get("plan_id");
        console.log(plan_id);

        var plan_name = 'Plan';
        var plan_price = 0.0;

        if (plan_id == 1) {
            plan_name = '7-day plan';
            plan_price = 4.99;
        } else {
            if (plan_id == 2) {
                plan_name = '1-month plan';
                plan_price = 14.99;
            } else {
                if (plan_id == 3) {
                    plan_name = '3-month plan';
                    plan_price = 21.99;
                } else {
                    console.log('error');
                    window.location.href = 'plan.html';
                }
            }
        }
        console.log(plan_name);
        console.log(plan_price);
        document.getElementById("plan_name").innerHTML = plan_name;
        document.getElementById("plan_price").innerHTML = plan_price;
        document.getElementById("plan_price_total").innerHTML = plan_price;



        let input = document.querySelector("#cardNumber"),
            numbers = /[0-9]/,
            regExp = /[0-9]{4}/
        // добавляем слушатель события на инпут
        input.addEventListener("input", (ev) => {
            // не позволяем ввести ничего, кроме цифр 0-9, ограничиваем размер поля 19-ю символами
            if (ev.inputType === "insertText" && !numbers.test(ev.data) || input.value.length > 19) {
                input.value = input.value.slice(0, input.value.length - 1)
                return
            }
            //работа клавиш "backspace","delete"
            let value = input.value
            if (ev.inputType === "deleteContentBackward" && regExp.test(value.slice(-4))) {
                input.value = input.value.slice(0, input.value.length - 1)
                return
            }
            //пробел после 4 цифр подряд
            if (regExp.test(value.slice(-4)) && value.length < 19) {
                input.value += " "
            }
        })

        let inputCVV = document.querySelector("#cvv"),
            numbersCVV = /[0-9]/
        // добавляем слушатель события на инпут
        inputCVV.addEventListener("input", (ev) => {
            // не позволяем ввести ничего, кроме цифр 0-9, ограничиваем размер поля 3-мя символами
            if (ev.inputType === "insertText" && !numbersCVV.test(ev.data) || inputCVV.value.length > 3) {
                inputCVV.value = inputCVV.value.slice(0, inputCVV.value.length - 1)
                return
            }
        })

        let inputDate = document.querySelector("#expiration-date"),
            numbersDate = /[0-9]/,
            regExpDate = /[0-9]{2}/
        // добавляем слушатель события на инпут
        inputDate.addEventListener("input", (ev) => {
            // не позволяем ввести ничего, кроме цифр 0-9, ограничиваем размер поля 5-ю символами
            if (ev.inputType === "insertText" && !numbersDate.test(ev.data) || inputDate.value.length > 5) {
                inputDate.value = inputDate.value.slice(0, inputDate.value.length - 1)
                return
            }
            //работа клавиш "backspace","delete"
            let value = inputDate.value
            if (ev.inputType === "deleteContentBackward" && regExpDate.test(value.slice(-2))) {
                inputDate.value = inputDate.value.slice(0, inputDate.value.length - 1)
                return
            }
            //пробел после 4 цифр подряд
            if (regExpDate.test(value.slice(-2)) && value.length < 5) {
                inputDate.value += "/"
            }
        })

        let inputOwner = document.querySelector("#owner"),
        ownerName =/^[a-zA-Za ]+$/
        inputOwner.addEventListener("input", (ev) => {
            // не позволяем ввести ничего, кроме букв, ограничиваем размер поля 50-ю символами
            if (ev.inputType === "insertText" && !ownerName.test(ev.data) || inputOwner.value.length > 50) {
                inputOwner.value = inputOwner.value.slice(0, inputOwner.value.length - 1)
                return
            }
        })


    </script>
</body>

</html>